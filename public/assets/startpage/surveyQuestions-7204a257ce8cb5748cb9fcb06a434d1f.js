(function(){var e;e=angular.module("SurveyQuestions",["StartPageServices"]),e.config(["$routeProvider",function(e){return e.when("/questions/:id",{templateUrl:"/assets/survey_questions.html",controller:"SurveyQuestionsController"})}]).controller("SurveyQuestionsController",["$scope","$http","$location","$routeParams","SharedRequests","StartPageData",function(e,t,n,r,i,o){var a,s,u,c,l;return e.allTopics=o.getAllTopics(),e.selectedTopicIds=o.getSelectedTopicIds(),e.currentTopicId=r.id,e.currentTopic=e.allTopics[e.currentTopicId].name,e.questions=[],e.questionCheckModel=o.getResponseIdsByTopicId(e.currentTopicId),e.numQuestions=0,e.handleResponseSelected=function(t,n){var r,i,a,s;for(a=t.survey_responses,r=0,i=a.length;i>r;r++)s=a[r],e.questionCheckModel[s.id]=!1;return e.questionCheckModel[n.id]=!0,o.addResponseIdsByTopicId(e.currentTopicId,e.questionCheckModel)},e.numUnansweredQuestions=function(){var t,n,r,i,o,a,s,u,c;for(a=e.questions.length,s=e.questions,t=0,r=s.length;r>t;t++)for(o=s[t],u=o.survey_responses,n=0,i=u.length;i>n;n++)if(c=u[n],e.questionCheckModel[c.id]){a-=1;break}return a},e.disableNextButton=function(){return e.numUnansweredQuestions()>0},e.nextButtonValue=function(){var t;return t=e.numUnansweredQuestions(),0===t?"Next":t+" Unanswered Questions"},s=function(){var t,r,i,a,s,u;for(s={},a=e.selectedTopicIds,r=0,i=a.length;i>r;r++)u=a[r],s[u]=o.getResponseIdsByTopicId(u);o.clearResponseIdsByTopics();for(u in s)t=s[u],o.addResponseIdsByTopicId(u,t);return n.path("summary")},a=function(e){return n.path("questions/"+e)},e.handleAdvance=function(){var t,n;return t=e.selectedTopicIds.indexOf(e.currentTopicId)+1,t<e.selectedTopicIds.length?(n=e.selectedTopicIds[t],a(n)):s()},c=function(){return n.path("topics")},u=function(e){return n.path("questions/"+e)},e.handleBack=function(){var t,n;return t=e.selectedTopicIds.indexOf(e.currentTopicId)-1,t>=0?(n=e.selectedTopicIds[t],u(n)):c()},(l=function(t){var n,r,o,a,s,u;if(i.requestQuestionsByTopic(t).success(function(t){var n,r,i;for(e.questions=[],t=t.sort(function(e,t){return e.index-t.index}),n=0,r=t.length;r>n;n++)i=t[n],e.questions.push(i);return e.numQuestions=e.questions.length}),e.currentTopic=e.allTopics[t].name,0===Object.keys(e.questionCheckModel).length){for(a=e.questions,u=[],n=0,r=a.length;r>n;n++)o=a[n],u.push(function(){var t,n,r,i;for(r=o.survey_responses,i=[],t=0,n=r.length;n>t;t++)s=r[t],i.push(e.questionCheckModel[s.id]=!1);return i}());return u}})(e.currentTopicId)}])}).call(this);